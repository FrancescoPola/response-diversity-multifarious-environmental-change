"0","(dd_spp <- pd_spp %>% transform( nxt_value_E1 = c(E1_ref[-1], NA)) %>% "
"0","    transform(nxt_value_E2 = c(E2_ref[-1], NA)) %>% "
"0","    dplyr::mutate(del_E1 = nxt_value_E1 - E1_ref,"
"0","                  del_E2 = nxt_value_E2 - E2_ref,"
"0","                  unit_vec_mag =  sqrt(del_E1^2 + del_E2^2),"
"0","                  uv_E1 = del_E1 / unit_vec_mag,"
"0","                  uv_E2 = del_E2 / unit_vec_mag,"
"0","                  dir_deriv = pd_E1 * uv_E1 +  pd_E2 * uv_E2) %>% "
"0","      filter(time != max(time)))"
